{% extends "projects/base.html" %}
{% load static %}

{% block scripts %}
    {% include "includes/schemas/weather_schema.html" %}
{% endblock scripts %}    

{% block styles %}  
{% endblock styles %}

{% block meta_tags %}
    <meta http-equiv="Cache-Control"  content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma"         content="no-cache">
    <meta http-equiv="Expires"        content="0">

    <meta name="description"          content="Get accurate and detailed weather forecasts with our Weather Forecast App. Enter a ZIP code to receive real-time weather updates, including temperature, precipitation, and more. Powered by Google Maps and OpenWeatherMap APIs.">
    <meta name="keywords"             content="Weather Forecast, ZIP Code Weather, Real-time Weather, Weather Updates">

    <meta property="og:url"           content="https://www.bencritt.net/projects/weather/">
    <meta property="og:type"          content="website">
    <meta property="og:title"         content="Weather Forecast App">
    <meta property="og:description"   content="This weather forecast app takes a ZIP code and returns a forecast and other weather information.">
    <meta property="og:image"         content="https://www.bencritt.net/static/img/all-projects/weather.webp">
    <meta property="og:image:type"    content="image/webp">
    <meta property="og:image:alt"     content="Weather Forecast Screenshot">
    <meta property="og:site_name"     content="Ben Crittenden">

    <meta name="twitter:card"         content="summary_large_image">
    <meta name="twitter:domain"       content="bencritt.net">
    <meta name="twitter:url"          content="https://www.bencritt.net/projects/weather/">
    <meta name="twitter:title"        content="Weather Forecast App">
    <meta name="twitter:description"  content="This weather forecast app takes a ZIP code and returns a forecast and other weather information.">
    <meta name="twitter:image"        content="https://www.bencritt.net/static/img/all-projects/weather.webp">
    <meta name="twitter:creator"      content="@bencritt89"/>
{% endblock meta_tags %}

{% block link_tags %}
    <link rel="canonical" href="https://www.bencritt.net/projects/weather/">
    <link href="{% static 'template-css/weather-css.css' %}" rel="stylesheet">
    {% endblock link_tags %}

{% block title %}Weather Forecast App | Accurate Weather by ZIP Code{% endblock title %}

{% block content %}
    <main>
      <center>
        <h1>Weather Forecast App</h1>
          <br>
          {% if error_message %}
          <div class="alert alert-danger u-container-narrow">
              {{ error_message }}
          </div>
          {% endif %}
          
          <div class="container u-container-narrow">
              <form action="{% url 'projects:weather' %}" method="post">
                  {% csrf_token %} 
                  {{ form.as_p }} 
                  <input type="submit" id="weather-btn" class="btn btn-primary" value="Get Weather Forecast" aria-label="Get Weather Forecast">
              </form>
          </div>
          <br>
          
          {% if city_name and state_name %}
              <h2>Weather Forecast for {{ city_name }}, {{ state_name }}</h2>
              <br>
              
              <div class="container u-container-narrow">
                
                {% if current_weather_report %}
                <div class="card">
                  <div class="card-header">
                    Current Weather Overview
                  </div>
                  <div class="card-body">
                    {% for current in current_weather_report %}
                    <div class="d-flex align-items-center mb-3">
                      <img src="{{ current.icon_url_current }}" alt="Weather Icon" class="weather-icon">
                      <div>
                        <p><strong>Description:</strong> {{ current.current_description }}</p>
                        <p><strong>Temperature:</strong> {{ current.current_temperature }}°F</p>
                        <p><strong>Humidity:</strong> {{ current.current_humidity }}%</p>
                      </div>
                    </div>
                    <hr>
                    <div class="row">
                      <div class="col-md-6">
                        <p><strong>Wind Speed:</strong> {{ current.current_wind_speed }} mph</p>
                        <p><strong>Wind Gusts:</strong> {{ current.current_wind_gust }} mph</p>
                        <p><strong>Wind Direction:</strong> {{ current.current_wind_direction }}°</p>
                      </div>
                      <div class="col-md-6">
                        <p><strong>UV Index:</strong> {{ current.current_uv }}</p>
                        <p><strong>Dew Point:</strong> {{ current.current_dew }}°F</p>
                        <p><strong>Cloud Coverage:</strong> {{ current.current_cloud }}%</p>
                      </div>
                    </div>
                    {% endfor %}
                  </div>
                </div>
                <br>
                {% endif %}

                {% if daily_forecast %}
                <h2>Daily Forecast</h2>
                <br>
                <div class="accordion" id="dailyForecastAccordion">
                  {% for day in daily_forecast %}
                  <div class="accordion-item">
                    <h3 class="accordion-header" id="heading{{ forloop.counter }}">
                      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ forloop.counter }}" aria-expanded="false" aria-controls="collapse{{ forloop.counter }}">
                        {{ day.day_of_week }}, {{ day.date|date:"F d" }}
                      </button>
                    </h3>
                    <div id="collapse{{ forloop.counter }}" class="accordion-collapse collapse {% if forloop.first %}show{% endif %}" aria-labelledby="heading{{ forloop.counter }}" data-bs-parent="#dailyForecastAccordion">
                      <div class="accordion-body">
                        <p><strong>Forecast Summary:</strong> {{ day.summary }}.</p>
                        <p><strong>High Temp:</strong> {{ day.high_temp }}°F</p>
                        <p><strong>Low Temp:</strong> {{ day.low_temp }}°F</p>
                        <p><strong>Precipitation Chance:</strong> {{ day.precipitation_chance }}%</p>
                        <p><strong>Humidity:</strong> {{day.humidity}}%</p>
                        <p><strong>Dew Point:</strong> {{day.dew_point}}°F</p>
                        <p><strong>Morning Temp:</strong> {{ day.morn_temp }}°F <span class="text-muted">(Feels like: {{ day.morn_temp_feel }}°F)</p>
                        <p><strong>Day Temp:</strong> {{ day.day_temp }}°F <span class="text-muted">(Feels like: {{ day.day_temp_feel }}°F)</p>
                        <p><strong>Evening Temp:</strong> {{ day.eve_temp }}°F <span class="text-muted">(Feels like: {{ day.eve_temp_feel }}°F)</p>
                        <p><strong>Night Temp:</strong> {{ day.night_temp }}°F <span class="text-muted">(Feels like: {{ day.night_temp_feel }}°F)</p>
                      </div>
                    </div>
                  </div>
                  {% endfor %}
                </div>
                {% endif %}
              </div>
          {% endif %}
          
          <br><br>
          
{% include 'includes/attribution.html' %}
      </center>
    </main>
{% endblock content %}